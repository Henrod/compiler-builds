{"version":3,"file":"html_parser.js","sourceRoot":"","sources":["../../../../../modules/@angular/compiler/src/i18n/html_parser.ts"],"names":[],"mappings":"AAAA;;;;;;GAMG;;AAGH,qCAAgE,mCAAmC,CAAC,CAAA;AACpG,uBAA8B,qBAAqB,CAAC,CAAA;AAEpD,iCAAgC,oBAAoB,CAAC,CAAA;AACrD,+BAA4B,kBAAkB,CAAC,CAAA;AAC/C,oBAAkB,mBAAmB,CAAC,CAAA;AACtC,mCAAgC,sBAAsB,CAAC,CAAA;AAEvD;IAIE,8EAA8E;IAC9E,uBAAuB;IACvB,qEAAqE;IACrE,oBAAoB,WAA2B,EAAU,aAAsB;QAA3D,gBAAW,GAAX,WAAW,CAAgB;QAAU,kBAAa,GAAb,aAAa,CAAS;IAAG,CAAC;IAEnF,0BAAK,GAAL,UACI,MAAc,EAAE,GAAW,EAAE,mBAAoC,EACjE,mBAAuE;QAD1C,mCAAoC,GAApC,2BAAoC;QACjE,mCAAuE,GAAvE,yEAAuE;QACzE,IAAM,WAAW,GACb,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,MAAM,EAAE,GAAG,EAAE,mBAAmB,EAAE,mBAAmB,CAAC,CAAC;QAElF,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,aAAa,IAAI,IAAI,CAAC,aAAa,KAAK,EAAE,CAAC,CAAC,CAAC;YACrD,4DAA4D;YAC5D,MAAM,CAAC,WAAW,CAAC;QACrB,CAAC;QAED,yDAAyD;QACzD,IAAM,aAAa,GAAG,IAAI,8BAAa,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;QAClE,IAAM,MAAM,GAAG,aAAa,CAAC,kBAAkB,CAAC,MAAM,EAAE,GAAG,EAAE,mBAAmB,CAAC,CAAC;QAElF,EAAE,CAAC,CAAC,MAAM,IAAI,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;YAC5B,MAAM,CAAC,IAAI,wBAAe,CAAC,WAAW,CAAC,SAAS,EAAE,WAAW,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;QACvF,CAAC;QAED,IAAM,GAAG,GAAG,IAAI,SAAG,CAAC,IAAI,CAAC,WAAW,EAAE,mBAAmB,CAAC,CAAC;QAC3D,IAAM,iBAAiB,GAAG,sCAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,GAAG,EAAE,aAAa,EAAE,GAAG,CAAC,CAAC;QAE9F,MAAM,CAAC,oCAAiB,CAAC,WAAW,CAAC,SAAS,EAAE,iBAAiB,EAAE,mBAAmB,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;IAClG,CAAC;IACH,iBAAC;AAAD,CAAC,AAjCD,IAiCC;AAjCY,kBAAU,aAiCtB,CAAA","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {HtmlParser as BaseHtmlParser} from '../ml_parser/html_parser';\nimport {DEFAULT_INTERPOLATION_CONFIG, InterpolationConfig} from '../ml_parser/interpolation_config';\nimport {ParseTreeResult} from '../ml_parser/parser';\n\nimport {mergeTranslations} from './extractor_merger';\nimport {MessageBundle} from './message_bundle';\nimport {Xtb} from './serializers/xtb';\nimport {TranslationBundle} from './translation_bundle';\n\nexport class HtmlParser implements BaseHtmlParser {\n  // @override\n  public getTagDefinition: any;\n\n  // TODO(vicb): transB.load() should not need a msgB & add transB.resolve(msgB,\n  // interpolationConfig)\n  // TODO(vicb): remove the interpolationConfig from the Xtb serializer\n  constructor(private _htmlParser: BaseHtmlParser, private _translations?: string) {}\n\n  parse(\n      source: string, url: string, parseExpansionForms: boolean = false,\n      interpolationConfig: InterpolationConfig = DEFAULT_INTERPOLATION_CONFIG): ParseTreeResult {\n    const parseResult =\n        this._htmlParser.parse(source, url, parseExpansionForms, interpolationConfig);\n\n    if (!this._translations || this._translations === '') {\n      // Do not enable i18n when no translation bundle is provided\n      return parseResult;\n    }\n\n    // TODO(vicb): add support for implicit tags / attributes\n    const messageBundle = new MessageBundle(this._htmlParser, [], {});\n    const errors = messageBundle.updateFromTemplate(source, url, interpolationConfig);\n\n    if (errors && errors.length) {\n      return new ParseTreeResult(parseResult.rootNodes, parseResult.errors.concat(errors));\n    }\n\n    const xtb = new Xtb(this._htmlParser, interpolationConfig);\n    const translationBundle = TranslationBundle.load(this._translations, url, messageBundle, xtb);\n\n    return mergeTranslations(parseResult.rootNodes, translationBundle, interpolationConfig, [], {});\n  }\n}\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}