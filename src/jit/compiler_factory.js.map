{"version":3,"sources":["../../../../../modules/@angular/compiler/src/jit/compiler_factory.ts"],"names":[],"mappings":"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","file":"compiler_factory.js","sourceRoot":"","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {COMPILER_OPTIONS, Compiler, CompilerFactory, CompilerOptions, Inject, InjectionToken, MissingTranslationStrategy, Optional, PLATFORM_INITIALIZER, PlatformRef, Provider, ReflectiveInjector, TRANSLATIONS, TRANSLATIONS_FORMAT, Type, ViewEncapsulation, createPlatformFactory, isDevMode, platformCore} from '@angular/core';\n\nimport {AnimationParser} from '../animation/animation_parser';\nimport {CompilerConfig} from '../config';\nimport {DirectiveNormalizer} from '../directive_normalizer';\nimport {DirectiveResolver} from '../directive_resolver';\nimport {DirectiveWrapperCompiler} from '../directive_wrapper_compiler';\nimport {Lexer} from '../expression_parser/lexer';\nimport {Parser} from '../expression_parser/parser';\nimport * as i18n from '../i18n/index';\nimport {CompilerInjectable} from '../injectable';\nimport {CompileMetadataResolver} from '../metadata_resolver';\nimport {HtmlParser} from '../ml_parser/html_parser';\nimport {NgModuleCompiler} from '../ng_module_compiler';\nimport {NgModuleResolver} from '../ng_module_resolver';\nimport {PipeResolver} from '../pipe_resolver';\nimport {Console, ReflectionCapabilities, Reflector, ReflectorReader, reflector} from '../private_import_core';\nimport {ResourceLoader} from '../resource_loader';\nimport {DomElementSchemaRegistry} from '../schema/dom_element_schema_registry';\nimport {ElementSchemaRegistry} from '../schema/element_schema_registry';\nimport {StyleCompiler} from '../style_compiler';\nimport {SummaryResolver} from '../summary_resolver';\nimport {TemplateParser} from '../template_parser/template_parser';\nimport {DEFAULT_PACKAGE_URL_PROVIDER, UrlResolver} from '../url_resolver';\nimport {ViewCompiler} from '../view_compiler/view_compiler';\n\nimport {JitCompiler} from './compiler';\n\nconst /** @type {?} */ _NO_RESOURCE_LOADER: ResourceLoader = {\n/**\n * @param {?} url\n * @return {?}\n */\nget(url: string): Promise<string>{\n      throw new Error(\n          `No ResourceLoader implementation has been provided. Can't read the url \"${url}\"`);}\n};\n\nconst /** @type {?} */ baseHtmlParser = new InjectionToken('HtmlParser');\n\n/**\n * A set of providers that provide `JitCompiler` and its dependencies to use for\n * template compilation.\n */\nexport const /** @type {?} */ COMPILER_PROVIDERS: Array<any|Type<any>|{[k: string]: any}|any[]> = [\n  {provide: Reflector, useValue: reflector},\n  {provide: ReflectorReader, useExisting: Reflector},\n  {provide: ResourceLoader, useValue: _NO_RESOURCE_LOADER},\n  SummaryResolver,\n  Console,\n  Lexer,\n  Parser,\n  {\n    provide: baseHtmlParser,\n    useClass: HtmlParser,\n  },\n  {\n    provide: i18n.I18NHtmlParser,\n    useFactory: (parser: HtmlParser, translations: string, format: string, config: CompilerConfig,\n                 console: Console) =>\n                    new i18n.I18NHtmlParser(\n                        parser, translations, format, config.missingTranslation, console),\n    deps: [\n      baseHtmlParser,\n      [new Optional(), new Inject(TRANSLATIONS)],\n      [new Optional(), new Inject(TRANSLATIONS_FORMAT)],\n      [CompilerConfig],\n      [Console],\n    ]\n  },\n  {\n    provide: HtmlParser,\n    useExisting: i18n.I18NHtmlParser,\n  },\n  TemplateParser,\n  DirectiveNormalizer,\n  CompileMetadataResolver,\n  DEFAULT_PACKAGE_URL_PROVIDER,\n  StyleCompiler,\n  ViewCompiler,\n  NgModuleCompiler,\n  DirectiveWrapperCompiler,\n  {provide: CompilerConfig, useValue: new CompilerConfig()},\n  JitCompiler,\n  {provide: Compiler, useExisting: JitCompiler},\n  DomElementSchemaRegistry,\n  {provide: ElementSchemaRegistry, useExisting: DomElementSchemaRegistry},\n  UrlResolver,\n  DirectiveResolver,\n  PipeResolver,\n  NgModuleResolver,\n  AnimationParser,\n];\n@CompilerInjectable()\nexport class JitCompilerFactory implements CompilerFactory {\nprivate _defaultOptions: CompilerOptions[];\n/**\n * @param {?} defaultOptions\n */\nconstructor( defaultOptions: CompilerOptions[]) {\n    this._defaultOptions = [<CompilerOptions>{\n                             useDebug: isDevMode(),\n                             useJit: true,\n                             defaultEncapsulation: ViewEncapsulation.Emulated,\n                             missingTranslation: MissingTranslationStrategy.Warning,\n                           }].concat(defaultOptions);\n  }\n/**\n * @param {?=} options\n * @return {?}\n */\ncreateCompiler(options: CompilerOptions[] = []): Compiler {\n    const /** @type {?} */ opts = _mergeOptions(this._defaultOptions.concat(options));\n    const /** @type {?} */ injector = ReflectiveInjector.resolveAndCreate([\n      COMPILER_PROVIDERS, {\n        provide: CompilerConfig,\n        useFactory: () => {\n          return new CompilerConfig({\n            // let explicit values from the compiler options overwrite options\n            // from the app providers. E.g. important for the testing platform.\n            genDebugInfo: opts.useDebug,\n            // let explicit values from the compiler options overwrite options\n            // from the app providers\n            useJit: opts.useJit,\n            // let explicit values from the compiler options overwrite options\n            // from the app providers\n            defaultEncapsulation: opts.defaultEncapsulation,\n            logBindingUpdate: opts.useDebug,\n            missingTranslation: opts.missingTranslation,\n          });\n        },\n        deps: []\n      },\n      opts.providers\n    ]);\n    return injector.get(Compiler);\n  }\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: Array, decorators: [{ type: Inject, args: [COMPILER_OPTIONS, ] }, ]},\n];\n}\n\nfunction JitCompilerFactory_tsickle_Closure_declarations() {\n/**\n * @nocollapse\n * @type {?}\n */\nJitCompilerFactory.ctorParameters;\n/** @type {?} */\nJitCompilerFactory.prototype._defaultOptions;\n}\n\n/**\n * @return {?}\n */\nfunction _initReflector() {\n  reflector.reflectionCapabilities = new ReflectionCapabilities();\n}\n\n/**\n * A platform that included corePlatform and the compiler.\n *\n * @experimental\n */\nexport const /** @type {?} */ platformCoreDynamic = createPlatformFactory(platformCore, 'coreDynamic', [\n  {provide: COMPILER_OPTIONS, useValue: {}, multi: true},\n  {provide: CompilerFactory, useClass: JitCompilerFactory},\n  {provide: PLATFORM_INITIALIZER, useValue: _initReflector, multi: true},\n]);\n/**\n * @param {?} optionsArr\n * @return {?}\n */\nfunction _mergeOptions(optionsArr: CompilerOptions[]): CompilerOptions {\n  return {\n    useDebug: _lastDefined(optionsArr.map(options => options.useDebug)),\n    useJit: _lastDefined(optionsArr.map(options => options.useJit)),\n    defaultEncapsulation: _lastDefined(optionsArr.map(options => options.defaultEncapsulation)),\n    providers: _mergeArrays(optionsArr.map(options => options.providers)),\n    missingTranslation: _lastDefined(optionsArr.map(options => options.missingTranslation)),\n  };\n}\n/**\n * @param {?} args\n * @return {?}\n */\nfunction _lastDefined<T>(args: T[]): T {\n  for (let /** @type {?} */ i = args.length - 1; i >= 0; i--) {\n    if (args[i] !== undefined) {\n      return args[i];\n    }\n  }\n  return undefined;\n}\n/**\n * @param {?} parts\n * @return {?}\n */\nfunction _mergeArrays(parts: any[][]): any[] {\n  const /** @type {?} */ result: any[] = [];\n  parts.forEach((part) => part && result.push(...part));\n  return result;\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}