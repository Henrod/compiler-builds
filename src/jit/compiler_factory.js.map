{"version":3,"sources":["../../../../../modules/@angular/compiler/src/jit/compiler_factory.ts"],"names":[],"mappings":"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","file":"compiler_factory.js","sourceRoot":"","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {COMPILER_OPTIONS, Compiler, CompilerFactory, CompilerOptions, Inject, InjectionToken, MissingTranslationStrategy, Optional, PLATFORM_INITIALIZER, PlatformRef, Provider, ReflectiveInjector, TRANSLATIONS, TRANSLATIONS_FORMAT, Type, ViewEncapsulation, createPlatformFactory, isDevMode, platformCore} from '@angular/core';\n\nimport {AnimationParser} from '../animation/animation_parser';\nimport {CompilerConfig, USE_VIEW_ENGINE} from '../config';\nimport {DirectiveNormalizer} from '../directive_normalizer';\nimport {DirectiveResolver} from '../directive_resolver';\nimport {DirectiveWrapperCompiler} from '../directive_wrapper_compiler';\nimport {Lexer} from '../expression_parser/lexer';\nimport {Parser} from '../expression_parser/parser';\nimport * as i18n from '../i18n/index';\nimport {CompilerInjectable} from '../injectable';\nimport {CompileMetadataResolver} from '../metadata_resolver';\nimport {HtmlParser} from '../ml_parser/html_parser';\nimport {NgModuleCompiler} from '../ng_module_compiler';\nimport {NgModuleResolver} from '../ng_module_resolver';\nimport {PipeResolver} from '../pipe_resolver';\nimport {Console, ReflectionCapabilities, Reflector, ReflectorReader, reflector} from '../private_import_core';\nimport {ResourceLoader} from '../resource_loader';\nimport {DomElementSchemaRegistry} from '../schema/dom_element_schema_registry';\nimport {ElementSchemaRegistry} from '../schema/element_schema_registry';\nimport {StyleCompiler} from '../style_compiler';\nimport {SummaryResolver} from '../summary_resolver';\nimport {TemplateParser} from '../template_parser/template_parser';\nimport {DEFAULT_PACKAGE_URL_PROVIDER, UrlResolver} from '../url_resolver';\nimport {ViewCompiler} from '../view_compiler/view_compiler';\nimport {ViewCompilerNext} from '../view_compiler_next/view_compiler';\n\nimport {JitCompiler} from './compiler';\n\nconst /** @type {?} */ _NO_RESOURCE_LOADER: ResourceLoader = {\n/**\n * @param {?} url\n * @return {?}\n */\nget(url: string): Promise<string>{\n      throw new Error(\n          `No ResourceLoader implementation has been provided. Can't read the url \"${url}\"`);}\n};\n\nconst /** @type {?} */ baseHtmlParser = new InjectionToken('HtmlParser');\n/**\n * @param {?} useViewEngine\n * @param {?} cc\n * @param {?} sr\n * @return {?}\n */\nfunction viewCompilerFactory(\n    useViewEngine: boolean, cc: CompilerConfig, sr: ElementSchemaRegistry) {\n  return useViewEngine ? new ViewCompilerNext(cc, sr) : new ViewCompiler(cc, sr);\n}\n\n/**\n * A set of providers that provide `JitCompiler` and its dependencies to use for\n * template compilation.\n */\nexport const /** @type {?} */ COMPILER_PROVIDERS: Array<any|Type<any>|{[k: string]: any}|any[]> = [\n  {provide: Reflector, useValue: reflector},\n  {provide: ReflectorReader, useExisting: Reflector},\n  {provide: ResourceLoader, useValue: _NO_RESOURCE_LOADER},\n  SummaryResolver,\n  Console,\n  Lexer,\n  Parser,\n  {\n    provide: baseHtmlParser,\n    useClass: HtmlParser,\n  },\n  {\n    provide: i18n.I18NHtmlParser,\n    useFactory: (parser: HtmlParser, translations: string, format: string, config: CompilerConfig,\n                 console: Console) =>\n                    new i18n.I18NHtmlParser(\n                        parser, translations, format, config.missingTranslation, console),\n    deps: [\n      baseHtmlParser,\n      [new Optional(), new Inject(TRANSLATIONS)],\n      [new Optional(), new Inject(TRANSLATIONS_FORMAT)],\n      [CompilerConfig],\n      [Console],\n    ]\n  },\n  {\n    provide: HtmlParser,\n    useExisting: i18n.I18NHtmlParser,\n  },\n  TemplateParser,\n  DirectiveNormalizer,\n  CompileMetadataResolver,\n  DEFAULT_PACKAGE_URL_PROVIDER,\n  StyleCompiler,\n  {provide: USE_VIEW_ENGINE, useValue: false},\n  {\n    provide: ViewCompiler,\n    useFactory: viewCompilerFactory,\n    deps: [USE_VIEW_ENGINE, CompilerConfig, ElementSchemaRegistry]\n  },\n  NgModuleCompiler,\n  DirectiveWrapperCompiler,\n  {provide: CompilerConfig, useValue: new CompilerConfig()},\n  JitCompiler,\n  {provide: Compiler, useExisting: JitCompiler},\n  DomElementSchemaRegistry,\n  {provide: ElementSchemaRegistry, useExisting: DomElementSchemaRegistry},\n  UrlResolver,\n  DirectiveResolver,\n  PipeResolver,\n  NgModuleResolver,\n  AnimationParser,\n];\n@CompilerInjectable()\nexport class JitCompilerFactory implements CompilerFactory {\nprivate _defaultOptions: CompilerOptions[];\n/**\n * @param {?} defaultOptions\n */\nconstructor( defaultOptions: CompilerOptions[]) {\n    this._defaultOptions = [<CompilerOptions>{\n                             useDebug: isDevMode(),\n                             useJit: true,\n                             defaultEncapsulation: ViewEncapsulation.Emulated,\n                             missingTranslation: MissingTranslationStrategy.Warning,\n                           }].concat(defaultOptions);\n  }\n/**\n * @param {?=} options\n * @return {?}\n */\ncreateCompiler(options: CompilerOptions[] = []): Compiler {\n    const /** @type {?} */ opts = _mergeOptions(this._defaultOptions.concat(options));\n    const /** @type {?} */ injector = ReflectiveInjector.resolveAndCreate([\n      COMPILER_PROVIDERS, {\n        provide: CompilerConfig,\n        useFactory: () => {\n          return new CompilerConfig({\n            // let explicit values from the compiler options overwrite options\n            // from the app providers. E.g. important for the testing platform.\n            genDebugInfo: opts.useDebug,\n            // let explicit values from the compiler options overwrite options\n            // from the app providers\n            useJit: opts.useJit,\n            // let explicit values from the compiler options overwrite options\n            // from the app providers\n            defaultEncapsulation: opts.defaultEncapsulation,\n            logBindingUpdate: opts.useDebug,\n            missingTranslation: opts.missingTranslation,\n          });\n        },\n        deps: []\n      },\n      opts.providers\n    ]);\n    return injector.get(Compiler);\n  }\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: Array, decorators: [{ type: Inject, args: [COMPILER_OPTIONS, ] }, ]},\n];\n}\n\nfunction JitCompilerFactory_tsickle_Closure_declarations() {\n/**\n * @nocollapse\n * @type {?}\n */\nJitCompilerFactory.ctorParameters;\n/** @type {?} */\nJitCompilerFactory.prototype._defaultOptions;\n}\n\n/**\n * @return {?}\n */\nfunction _initReflector() {\n  reflector.reflectionCapabilities = new ReflectionCapabilities();\n}\n\n/**\n * A platform that included corePlatform and the compiler.\n *\n * @experimental\n */\nexport const /** @type {?} */ platformCoreDynamic = createPlatformFactory(platformCore, 'coreDynamic', [\n  {provide: COMPILER_OPTIONS, useValue: {}, multi: true},\n  {provide: CompilerFactory, useClass: JitCompilerFactory},\n  {provide: PLATFORM_INITIALIZER, useValue: _initReflector, multi: true},\n]);\n/**\n * @param {?} optionsArr\n * @return {?}\n */\nfunction _mergeOptions(optionsArr: CompilerOptions[]): CompilerOptions {\n  return {\n    useDebug: _lastDefined(optionsArr.map(options => options.useDebug)),\n    useJit: _lastDefined(optionsArr.map(options => options.useJit)),\n    defaultEncapsulation: _lastDefined(optionsArr.map(options => options.defaultEncapsulation)),\n    providers: _mergeArrays(optionsArr.map(options => options.providers)),\n    missingTranslation: _lastDefined(optionsArr.map(options => options.missingTranslation)),\n  };\n}\n/**\n * @param {?} args\n * @return {?}\n */\nfunction _lastDefined<T>(args: T[]): T {\n  for (let /** @type {?} */ i = args.length - 1; i >= 0; i--) {\n    if (args[i] !== undefined) {\n      return args[i];\n    }\n  }\n  return undefined;\n}\n/**\n * @param {?} parts\n * @return {?}\n */\nfunction _mergeArrays(parts: any[][]): any[] {\n  const /** @type {?} */ result: any[] = [];\n  parts.forEach((part) => part && result.push(...part));\n  return result;\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}